<!-- templates/views/common/header.html -->
<th:block th:fragment="header-fragment" xmlns:sec="http://www.w3.org/1999/xhtml">
    <header>
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2><a th:href="@{/}">ROOFY</a></h2>

            <!-- 사용자 헤더 -->
            <div sec:authorize="hasRole('USER')">
                <span style="cursor: pointer; text-decoration: underline;"
                      onclick="openMapFromHeader()"
                      th:text="${#authentication.principal.user.areaName}">
                    위치
                </span>
                <span th:text="${#authentication.principal.user.name}">닉네임</span>
                <a th:href="@{/mypage}">마이페이지</a>

                <!-- 로그인/로그아웃 토글 -->
                <span sec:authorize="!isAuthenticated()">
                    <a th:href="@{/user/login}">로그인</a>
                </span>
                <span sec:authorize="isAuthenticated()">
                    <a th:href="@{/user/logout}">로그아웃</a>
                </span>
            </div>

            <!-- 관리자 헤더 -->
            <div sec:authorize="hasRole('ADMIN')">
                <span th:text="${#authentication.principal.user.name}">관리자명</span>
                <span sec:authorize="!isAuthenticated()">
                    <a th:href="@{/user/login}">로그인</a>
                </span>
                <span sec:authorize="isAuthenticated()">
                    <a th:href="@{/user/logout}">로그아웃</a>
                </span>
            </div>
        </div>
    </header>

    <!-- 지도 띄울 모달 -->
    <div class="modal fade" id="headerMapModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header"><h5 class="modal-title">내 위치</h5></div>
                <div class="modal-body">
                    <div id="headerMap" style="width: 100%; height: 400px;"></div>
                    <p><strong>행정구역:</strong> <span id="headerAddressOutput">-</span></p>
                </div>
            </div>
        </div>
    </div>

    <!-- openMapFromHeader 함수 -->
    <script>
        function openMapFromHeader() {
            openMap("headerMap", "headerMapModal", "headerAddressOutput");
        }
    </script>
</th:block>
